<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NavaChetana ‚Äî Branch Viewer (PROFILE_DEMO)</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    * { box-sizing: border-box; }
    html, body { width:100%; max-width:100%; overflow-x:hidden; transition: background-color 0.3s ease, color 0.3s ease; }
    :root{
      --ink:#1f2937; --muted:#6b7280; --border:#e5e7eb; --ring:#93c5fd;
      --pillA:#10b981; --pillB:#f59e0b; --pillC:#ef4444; --pillD:#6b7280;
      --hit:#fff7ed; --zebra:#fafafa;
      --bg:#ffffff; --card-bg:#ffffff; --header-bg:#fafbfc;
    }
    [data-theme="dark"] {
      --ink:#f3f4f6; --muted:#9ca3af; --border:#374151; --ring:#60a5fa;
      --zebra:#1f2937; --hit:#78350f;
      --bg:#111827; --card-bg:#1f2937; --header-bg:#0f172a;
    }
    .glance-page{ background:var(--bg); color:var(--ink); font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; padding-bottom:32px; min-height:100vh; }
    .logo-img{ width:40px;height:40px;border-radius:8px;object-fit:cover; box-shadow:0 2px 8px rgba(0,0,0,.1); transition: transform 0.2s ease; }
    .logo-img:hover{ transform: scale(1.05); }
    header{ background:var(--header-bg)!important; border-bottom-color:var(--border)!important; transition: background-color 0.3s ease; }
    #page{ display:grid; grid-template-columns:minmax(0,1fr) 380px; gap:1.25rem; max-width:1280px; margin:0 auto; padding: clamp(1rem, 2vw, 2rem) 1rem; align-items:start; }
    .page-title{ grid-column:1 / -1; text-align:center; font-size:1.5rem; font-weight:800; margin:0 0 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; animation: fadeInDown 0.6s ease; }
    [data-theme="dark"] .page-title{ background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
    @keyframes fadeInDown{ from{ opacity:0; transform:translateY(-20px); } to{ opacity:1; transform:translateY(0); } }
    .kpi-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:1rem; }
    .kpi-card{ background:var(--card-bg); border:1px solid var(--border); border-radius:16px; padding:1.25rem; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,.05), 0 10px 15px rgba(0,0,0,.1); transition: all 0.3s ease; position:relative; overflow:hidden; }
    .kpi-card::before{ content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, #667eea, #764ba2); opacity:0; transition: opacity 0.3s ease; }
    .kpi-card:hover{ transform: translateY(-4px); box-shadow:0 12px 24px rgba(0,0,0,.15); }
    .kpi-card:hover::before{ opacity:1; }
    .kpi-card:nth-child(1)::before{ background:linear-gradient(90deg, #10b981, #059669); }
    .kpi-card:nth-child(2)::before{ background:linear-gradient(90deg, #3b82f6, #2563eb); }
    .kpi-card:nth-child(3)::before{ background:linear-gradient(90deg, #8b5cf6, #7c3aed); }
    .kpi-card:nth-child(4)::before{ background:linear-gradient(90deg, #f59e0b, #d97706); }
    .kpi-card:nth-child(5)::before{ background:linear-gradient(90deg, #ef4444, #dc2626); }
    .kpi-card:nth-child(6)::before{ background:linear-gradient(90deg, #06b6d4, #0891b2); }
    .kpi-label{ font-weight:600; color:var(--muted); font-size:.85rem; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:0.5rem; }
    .kpi-value{ margin-top:.5rem; font-size:1.5rem; font-weight:800; color:var(--ink); transition: color 0.3s ease; }
    .kpi-delta{ margin-top:.5rem; font-size:.75rem; color:var(--muted); font-weight:500; }
    .kpi-delta:not(:empty)::before{ content:'‚Üó '; }
    .span-all{ grid-column:1 / -1; }
    .badge-pill{ display:inline-flex; align-items:center; gap:.4rem; padding:.4rem .75rem; border-radius:999px; font-weight:700; font-size:.85rem; border:1px solid var(--border); transition: all 0.2s ease; }
    .badge-pill:hover{ transform: scale(1.05); }
    .pill-A{ color:#065f46; background:#ecfdf5; border-color:#d1fae5;}
    .pill-B{ color:#7c2d12; background:#fff7ed; border-color:#ffedd5;}
    .pill-C{ color:#7f1d1d; background:#fef2f2; border-color:#fee2e2;}
    .pill-D{ color:#111827; background:#f3f4f6; border-color:#e5e7eb;}
    [data-theme="dark"] .pill-D{ color:#f3f4f6; background:#374151; border-color:#4b5563;}
    .card{ background:var(--card-bg); border:1px solid var(--border); border-radius:16px; padding:1.25rem; box-shadow:0 4px 6px rgba(0,0,0,.05), 0 10px 15px rgba(0,0,0,.1); transition: all 0.3s ease; }
    .card:hover{ box-shadow:0 8px 12px rgba(0,0,0,.1), 0 15px 25px rgba(0,0,0,.15); }
    .controls { display:flex; gap:0.75rem; align-items:center; margin:.5rem 0 0.75rem; flex-wrap:wrap; }
    select, input { padding:.6rem .8rem; border:1px solid var(--border); border-radius:10px; background:var(--card-bg); color:var(--ink); transition: all 0.2s ease; font-size:0.9rem; }
    select:focus, input:focus{ outline:none; border-color:var(--ring); box-shadow:0 0 0 3px rgba(147,197,253,.2); }
    select:hover, input:hover{ border-color:var(--muted); }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Segoe UI Mono", monospace; }
    .table-box{ margin-top:1.0rem; background:var(--card-bg); border:1px solid var(--border); border-radius:16px; box-shadow:0 4px 6px rgba(0,0,0,.05), 0 10px 15px rgba(0,0,0,.1); overflow:hidden; transition: all 0.3s ease; }
    .table-header{ position:sticky; top:0; z-index:5; background:var(--header-bg); display:flex; justify-content:space-between; align-items:center; padding:1rem 1.25rem; gap:.5rem; border-bottom:2px solid var(--border); transition: background-color 0.3s ease; }
    .table-title{ font-size:1.1rem; font-weight:700; margin:0; color:var(--ink); }
    .table-actions{ display:flex; gap:.5rem; align-items:center; }
    .icon-btn{ border:1px solid var(--border); background:var(--card-bg); color:var(--ink); padding:.5rem .7rem; border-radius:10px; cursor:pointer; transition: all 0.2s ease; font-size:1rem; }
    .icon-btn:hover{ background:var(--zebra); transform: scale(1.05); border-color:var(--ring); }
    .icon-btn:active{ transform: scale(0.95); }
    .table-badge{ font-size:.75rem; color:var(--muted); background:var(--zebra); padding:.35rem .65rem; border-radius:999px; font-weight:600; border:1px solid var(--border); }
    .table-scroller{ overflow:auto; max-height:min(60vh, 620px); }
    table.table-grid{ width:max(1200px, 100%); border-collapse:separate; border-spacing:0; font-size:13px; table-layout:fixed; }
    .table-grid th, .table-grid td{ border-right:1px solid var(--border); border-bottom:1px solid var(--border); padding:.6rem .75rem; text-align:left; vertical-align:top; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; background:var(--card-bg); color:var(--ink); transition: background-color 0.2s ease; }
    .table-grid thead th{ position:sticky; top:0; background:var(--header-bg); z-index:4; font-weight:700; color:var(--ink); }
    .table-grid tbody tr:nth-child(odd) td{ background:var(--zebra); }
    .table-grid tbody tr:hover td{ background:#eef2ff; transition: background-color 0.15s ease; }
    [data-theme="dark"] .table-grid tbody tr:hover td{ background:#1e3a8a; }
    .table-grid th:first-child, .table-grid td:first-child{ position:sticky; left:0; z-index:3; background:var(--header-bg); }
    .cell-hit{ background:var(--hit)!important; font-weight:600; }
    .th-sort{ cursor:pointer; user-select:none; transition: background-color 0.2s ease; }
    .th-sort:hover{ background:var(--zebra); }
    .th-sort .dir{ opacity:.7; font-size:.85em; margin-left:.35rem; transition: opacity 0.2s ease; }
    .cols-menu{ position:relative; }
    .cols-pop{ position:absolute; right:0; top:110%; width:260px; background:var(--card-bg); border:1px solid var(--border); border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.15); padding:.75rem; display:none; z-index:20; animation: slideDown 0.2s ease; }
    @keyframes slideDown{ from{ opacity:0; transform:translateY(-10px); } to{ opacity:1; transform:translateY(0); } }
    .cols-pop.show{ display:block; }
    .table-box{ transition: transform .25s ease, opacity .25s ease; }
    .table-box:fullscreen { border-radius:0; width:100vw; height:100vh; background:var(--bg); }
    .table-box:fullscreen .table-scroller{ max-height: calc(100vh - 160px); }
    .fs-close{ display:none; }
    .table-box:fullscreen .fs-close{ display:inline-flex; }
    .fade-in{ animation:fadeIn .3s ease; } 
    @keyframes fadeIn{ from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }
    .staff-count { font-weight:700; font-size:1.1rem; text-align:center; cursor:pointer; transition: all 0.2s ease; padding:0.5rem; border-radius:8px; }
    .staff-count:hover{ text-decoration:underline; background:var(--zebra); transform: scale(1.1); }
    .drawer{ position:fixed; right:16px; bottom:16px; width:min(420px, 92vw); max-height:70vh; overflow:auto; background:var(--card-bg); border:1px solid var(--border); border-radius:16px; box-shadow:0 20px 50px rgba(0,0,0,.3); padding:1.5rem; display:none; z-index:60; animation: slideUp 0.3s ease; }
    @keyframes slideUp{ from{ opacity:0; transform:translateY(20px); } to{ opacity:1; transform:translateY(0); } }
    .drawer.show{ display:block; }
    .drawer h3{ margin:0 0 .75rem; font-weight:800; color:var(--ink); }
    .toasts{ position:fixed; right:16px; top:80px; z-index:80; display:flex; flex-direction:column; gap:.5rem; }
    .toast{ background:#111827; color:#fff; border-radius:12px; padding:.75rem 1rem; box-shadow:0 14px 30px rgba(0,0,0,.3); display:flex; align-items:center; gap:.75rem; animation: slideInRight 0.3s ease; min-width:300px; transition: all 0.3s ease; }
    [data-theme="dark"] .toast{ background:#1f2937; border:1px solid #374151; }
    @keyframes slideInRight{ from{ opacity:0; transform:translateX(100px); } to{ opacity:1; transform:translateX(0); } }
    .toast button{ background:#374151; color:#fff; border:none; border-radius:8px; padding:.4rem .75rem; cursor:pointer; transition: all 0.2s ease; }
    .toast button:hover{ background:#4b5563; transform: scale(1.05); }
    .offline{ display:none; background:#fff7ed; border-bottom:2px solid #fed7aa; color:#7c2d12; padding:.6rem .8rem; text-align:center; font-weight:600; }
    .offline.show{ display:block; animation: slideDown 0.3s ease; }
    .scopebar{ display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; }
    .scopebtn{ padding:.5rem 1rem; border:2px solid var(--border); border-radius:999px; cursor:pointer; background:var(--card-bg); color:var(--ink); font-weight:600; transition: all 0.2s ease; }
    .scopebtn:hover{ border-color:var(--ring); transform: translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,.1); }
    .scopebtn[aria-pressed="true"]{ background:linear-gradient(135deg, #0ea5e9, #0284c7); color:#fff; border-color:#0284c7; box-shadow:0 4px 12px rgba(14,165,233,.4); }
    .scope-ind{ margin-left:auto; font-size:.85rem; color:var(--muted); font-weight:500; }
    button{ transition: all 0.2s ease; }
    button:hover{ transform: translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,.15); }
    button:active{ transform: translateY(0); }
    .loading{ position:relative; overflow:hidden; }
    .loading::after{ content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg, transparent, rgba(255,255,255,.3), transparent); animation: loading 1.5s infinite; }
    @keyframes loading{ to{ left:100%; } }
    .theme-toggle{ position:fixed; bottom:24px; left:24px; z-index:70; width:56px; height:56px; border-radius:50%; background:var(--card-bg); border:2px solid var(--border); box-shadow:0 4px 12px rgba(0,0,0,.15); cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:1.5rem; transition: all 0.3s ease; }
    .theme-toggle:hover{ transform: scale(1.1) rotate(15deg); box-shadow:0 6px 20px rgba(0,0,0,.2); }
    @page { size: A4 landscape; margin: 12mm; }
    @media print{
      header, .controls, .table-actions .cols-menu, #right-rail, .scopebar, .offline, .theme-toggle { display:none!important; }
      #page{ grid-template-columns:1fr!important; }
      .table-scroller{ max-height:unset!important; overflow:visible!important; }
      .card, .table-box, .kpi-card { box-shadow:none!important; }
    }
    @media(max-width:1100px){
      #page{ grid-template-columns:1fr; max-width:100%; }
      .kpi-grid{ grid-template-columns:repeat(2,1fr); }
      .theme-toggle{ bottom:16px; left:16px; width:48px; height:48px; font-size:1.25rem; }
    }
    @media(max-width:640px){
      .kpi-grid{ grid-template-columns:1fr; }
      header{ flex-wrap:wrap; padding:0.75rem 1rem!important; }
      header > div:last-child{ width:100%; margin-top:0.75rem; display:grid; grid-template-columns:repeat(2,1fr); gap:0.5rem; }
      header > div:last-child button{ font-size:0.8rem; padding:0.6rem 0.5rem; width:100%; }
      .controls{ flex-direction:column; align-items:stretch; }
      .controls > *{ width:100%; }
      .controls > div:last-child{ margin-left:0!important; margin-top:0.5rem; }
      .page-title{ font-size:1.25rem!important; }
    }
    .focus-ring:focus{ outline:2px solid var(--ring); outline-offset:2px; border-radius:8px; }
    .skeleton{ background:linear-gradient(90deg, var(--zebra) 25%, var(--border) 50%, var(--zebra) 75%); background-size:200% 100%; animation: skeleton 1.5s infinite; }
    @keyframes skeleton{ to{ background-position:200% 0; } }
  </style>
</head>
<body class="glance-page">
  <div id="offline" class="offline" role="status" aria-live="polite">You‚Äôre offline ‚Äî showing cached data (some actions disabled).</div>

  <header style="display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;border-bottom:1px solid #e5e7eb;">
    <img src="Official Logo.jpg" alt="Logo" class="logo-img" />
    <div>
      <div style="font-weight:700;font-size:1.05rem">NavaChetana Livelihoods</div>
      <div style="font-size:.8rem;color:var(--muted)">Branch Explorer ‚Äî PROFILE_DEMO</div>
    </div>
    <div style="margin-left:auto;display:flex;gap:.5rem;align-items:center;">
      <button id="btn-refresh" class="px-4 py-2 rounded-lg bg-gradient-to-r from-sky-500 to-sky-600 text-white text-sm font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2" aria-label="Refresh">üîÑ Refresh</button>
      <button id="btn-download" class="px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-500 to-indigo-600 text-white text-sm font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" aria-label="Download CSV">üì• CSV</button>
      <button id="btn-xlsx" class="px-4 py-2 rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 text-white text-sm font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2" aria-label="Download Excel">üìä XLSX</button>
      <button id="btn-print" class="px-4 py-2 rounded-lg bg-gradient-to-r from-gray-700 to-gray-800 text-white text-sm font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2" aria-label="Print report">üñ®Ô∏è Print</button>
    </div>
  </header>

  <div id="page">
    <h1 class="page-title">Current Outreach ‚Äî Branch Detail</h1>

    <!-- MAIN CONTENT -->
    <main id="content">
      <!-- Scope bar -->
      <div class="scopebar card" role="toolbar" aria-label="Scope">
        <button class="scopebtn" id="sc_company" aria-pressed="false">Company</button>
        <button class="scopebtn" id="sc_region"  aria-pressed="false">Region</button>
        <button class="scopebtn" id="sc_district" aria-pressed="false">District</button>
        <button class="scopebtn" id="sc_branch"  aria-pressed="true">Branch</button>
        <div id="scope_ind" class="scope-ind">Current: Branch (UI demo)</div>
      </div>

      <div class="controls" aria-live="polite">
        <label class="text-sm text-[var(--muted)]" for="branchSelect">Branch</label>
        <select id="branchSelect" aria-label="Branch select">
          <option value="">‚Äî All branches ‚Äî</option>
        </select>

        <label class="text-sm text-[var(--muted)]" for="search">Search <span style="font-size:0.75rem;opacity:0.7;">(Press /)</span></label>
        <input id="search" placeholder="Search rows (UI demo ‚Äî no data)" aria-label="Search all visible columns" style="min-width:250px;" />

        <label class="text-sm text-[var(--muted)]" for="pageSize">Rows/page</label>
        <select id="pageSize" aria-label="Rows per page">
          <option>100</option>
          <option>200</option>
          <option>500</option>
        </select>

        <div style="margin-left:auto;display:flex;align-items:center;gap:.65rem;flex-wrap:wrap;">
          <span class="text-sm text-[var(--muted)]" id="status">UI demo ‚Äî no live data connected</span>
          <span id="tick" aria-hidden="true" class="inline-block w-3 h-3 rounded-full" style="background:var(--border);transition:background 0.3s ease;"></span>
          <span class="text-xs text-[var(--muted)]" style="opacity:0.6;" title="Keyboard shortcuts: / = Search, B = Branch, F = Fullscreen, R = Refresh, D = Download CSV, X = Download XLSX, P = Print">‚å®Ô∏è Shortcuts</span>
        </div>
      </div>

      <!-- KPI GRID -->
      <section class="kpi-grid" aria-live="polite">
        <div class="kpi-card">
          <div class="kpi-label">ACTIVE ACCOUNTS</div>
          <div id="k_active" class="kpi-value">‚Äî</div>
          <div id="k_active_delta" class="kpi-delta"></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">TOTAL PORTFOLIO</div>
          <div id="k_total" class="kpi-value">‚Äî</div>
          <div id="k_total_delta" class="kpi-delta"></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">REGULAR PORTFOLIO</div>
          <div id="k_regular" class="kpi-value">‚Äî</div>
          <div id="k_regular_delta" class="kpi-delta"></div>
        </div>

        <div class="kpi-card">
          <div class="kpi-label">1+ PAR</div>
          <div id="k_par" class="kpi-value">‚Äî</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">NPA</div>
          <div id="k_npa" class="kpi-value">‚Äî</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">MAN POWER (Unique Employees)</div>
          <div id="k_manpower" class="kpi-value">‚Äî</div>
        </div>

        <div class="kpi-card span-all">
          <div class="kpi-label">AUDIT RATING</div>
          <div id="k_audit" class="kpi-value"><span class="badge-pill pill-D">‚Äî</span></div>
        </div>
      </section>

      <!-- TABLE -->
      <div class="table-box fade-in" id="tableBox">
        <div class="table-header">
          <h2 class="table-title">Filtered Rows ‚Äî PROFILE_DEMO (UI only)</h2>
          <div class="table-actions">
            <span class="table-badge" id="rowsCount">0 rows</span>
            <div class="cols-menu">
              <button id="btn-cols" class="icon-btn" title="Show/hide columns" aria-haspopup="true" aria-expanded="false">‚ò∞</button>
              <div class="cols-pop" id="cols-pop" role="menu" aria-label="Columns">
                <div class="text-xs text-[var(--muted)]">
                  Column visibility controls will appear here once data logic is connected.
                </div>
              </div>
            </div>
            <button id="btn-fs" class="icon-btn" title="Toggle fullscreen" aria-label="Toggle fullscreen">‚õ∂</button>
            <button id="btn-fs-close" class="icon-btn fs-close" title="Exit fullscreen" aria-label="Exit fullscreen">√ó</button>
          </div>
        </div>
        <div class="table-scroller">
          <table class="table-grid" id="rowsTable"></table>
        </div>
        <div class="flex items-center justify-between px-3 py-2 border-t border-[var(--border)]">
          <div id="pageInfo" class="text-sm text-[var(--muted)]">Page 1 of 1</div>
          <div class="flex items-center gap-2">
            <button id="btn-prev" class="icon-btn" aria-label="Previous page" disabled>‚Üê</button>
            <button id="btn-next" class="icon-btn" aria-label="Next page" disabled>‚Üí</button>
          </div>
        </div>
      </div>
    </main>

    <!-- RIGHT RAIL -->
    <aside id="right-rail">
      <section class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:.75rem;">
          <h2 style="margin:0;font-size:1rem;font-weight:700">Achiever of the Month</h2>
          <label class="text-xs text-[var(--muted)]" for="ach_metric">Pick by</label>
        </div>
        <select id="ach_metric" style="margin:.5rem 0;width:100%;" aria-label="Achiever metric"></select>
        <label class="inline-flex items-center gap-2 text-sm text-[var(--muted)] mb-2">
          <input type="checkbox" id="ach_only_field" />
          Only Field Staff (FO/SE/SO)
        </label>
        <div class="ach-grid" id="achieverGrid" style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem;">
          <div><b>Name</b><div id="ach_name">‚Äî</div></div>
          <div><b>Chosen Metric Value</b><div id="ach_metric_value">‚Äî</div></div>
          <div><b>Customer Base</b><div id="ach_base">‚Äî</div></div>
          <div><b>Maintained Portfolio</b><div id="ach_port">‚Äî</div></div>
          <div><b>Disbursement</b><div id="ach_disb">‚Äî</div></div>
          <div style="grid-column:1/-1"><b>Collection Efficiency</b><div id="ach_coll">‚Äî</div></div>
        </div>
      </section>

      <div style="height:1.0rem"></div>

      <section class="card">
        <h3 style="margin:0 0 .5rem;font-weight:800;">Staff Breakdown</h3>
        <table class="staff-table" style="width:100%;border-collapse:collapse;font-size:13px;">
          <caption class="sr-only">Staff counts by role</caption>
          <thead>
            <tr>
              <th style="padding:.5rem" scope="col">DM</th>
              <th style="padding:.5rem" scope="col">BM / ABM / BSM</th>
              <th style="padding:.5rem" scope="col">FO / SE / SO</th>
              <th style="padding:.5rem" scope="col">BOE</th>
              <th style="padding:.5rem" scope="col">CO</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td id="staff_dm"  style="padding:.6rem;vertical-align:middle"><div class="staff-count" data-bucket="DM">‚Äî</div></td>
              <td id="staff_bm"  style="padding:.6rem;vertical-align:middle"><div class="staff-count" data-bucket="BM">‚Äî</div></td>
              <td id="staff_fo"  style="padding:.6rem;vertical-align:middle"><div class="staff-count" data-bucket="FO">‚Äî</div></td>
              <td id="staff_boe" style="padding:.6rem;vertical-align:middle"><div class="staff-count" data-bucket="BOE">‚Äî</div></td>
              <td id="staff_co"  style="padding:.6rem;vertical-align:middle"><div class="staff-count" data-bucket="CO">‚Äî</div></td>
            </tr>
          </tbody>
        </table>
      </section>

      <div style="height:1.0rem"></div>

      <section class="card">
        <h3 style="margin:0 0 .5rem;font-weight:800;">Productivity</h3>
        <div class="flex gap-2 mb-2">
          <label class="text-xs text-[var(--muted)]">Month
            <select id="prod_month"></select>
          </label>
          <label class="text-xs text-[var(--muted)]">Year
            <select id="prod_year"></select>
          </label>
          <label class="text-xs text-[var(--muted)]">Metric
            <select id="prod_metric"></select>
          </label>
        </div>
        <div class="grid grid-cols-2 gap-2 text-sm">
          <div class="p-2 border rounded">
            <div class="text-[var(--muted)]">Total Metric</div>
            <div id="prod_total" class="font-bold">‚Äî</div>
          </div>
          <div class="p-2 border rounded">
            <div class="text-[var(--muted)]">FO Count</div>
            <div id="prod_fo" class="font-bold">‚Äî</div>
          </div>
          <div class="col-span-2 p-2 border rounded">
            <div class="text-[var(--muted)]">Per-FO Average</div>
            <div id="prod_avg" class="font-bold text-lg">‚Äî</div>
          </div>
        </div>
      </section>
    </aside>
  </div>

  <footer style="text-align:center;color:var(--muted);font-size:.85rem;padding:1rem 0;">¬© <span id="year"></span> NavaChetana Livelihoods</footer>

  <!-- Dark Mode Toggle -->
  <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
    <span id="theme-icon">üåô</span>
  </button>

  <!-- Staff names drawer -->
  <div id="drawer" class="drawer" role="dialog" aria-modal="true" aria-labelledby="drawer_title">
    <div class="flex items-center justify-between">
      <h3 id="drawer_title">Staff</h3>
      <button id="drawer_close" class="icon-btn" aria-label="Close">√ó</button>
    </div>
    <div id="drawer_meta" class="text-sm text-[var(--muted)] mb-2"></div>
    <ol id="drawer_list" class="list-decimal pl-5"></ol>
  </div>

  <!-- Toasts -->
  <div id="toasts" class="toasts" aria-live="polite"></div>

  <!-- UI-only app logic (no data) -->
  <script>
    // Year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== Dark Mode Toggle =====
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon   = document.getElementById('theme-icon');
    const html        = document.documentElement;

    const savedTheme = localStorage.getItem('theme') || 'light';
    if (savedTheme === 'dark') {
      html.setAttribute('data-theme', 'dark');
      themeIcon.textContent = '‚òÄÔ∏è';
    } else {
      html.removeAttribute('data-theme');
      themeIcon.textContent = 'üåô';
    }

    themeToggle.addEventListener('click', () => {
      const currentTheme = html.getAttribute('data-theme');
      if (currentTheme === 'dark') {
        html.removeAttribute('data-theme');
        themeIcon.textContent = 'üåô';
        localStorage.setItem('theme', 'light');
      } else {
        html.setAttribute('data-theme', 'dark');
        themeIcon.textContent = '‚òÄÔ∏è';
        localStorage.setItem('theme', 'dark');
      }
    });

    // ===== Simple Toast Helper =====
    const toasts = document.getElementById('toasts');
    function showToast(msg) {
      const div = document.createElement('div');
      div.className = 'toast';
      div.textContent = msg;
      toasts.appendChild(div);
      setTimeout(() => div.remove(), 3500);
    }

    // ===== Elements =====
    const el = {
      rowsTable: document.getElementById('rowsTable'),
      rowsCount: document.getElementById('rowsCount'),
      pageInfo:  document.getElementById('pageInfo'),
      btnPrev:   document.getElementById('btn-prev'),
      btnNext:   document.getElementById('btn-next'),
      status:    document.getElementById('status'),
      tick:      document.getElementById('tick'),
      colsBtn:   document.getElementById('btn-cols'),
      colsPop:   document.getElementById('cols-pop'),
      tableBox:  document.getElementById('tableBox'),
      btnFS:     document.getElementById('btn-fs'),
      btnFSX:    document.getElementById('btn-fs-close'),
      btnRefresh: document.getElementById('btn-refresh'),
      btnDownload: document.getElementById('btn-download'),
      btnXlsx:     document.getElementById('btn-xlsx'),
      btnPrint:    document.getElementById('btn-print'),
      search:      document.getElementById('search'),
      branchSelect: document.getElementById('branchSelect'),
      offline:     document.getElementById('offline'),
      drawer:      document.getElementById('drawer'),
      drawerClose: document.getElementById('drawer_close'),
      drawerTitle: document.getElementById('drawer_title'),
      drawerMeta:  document.getElementById('drawer_meta'),
      drawerList:  document.getElementById('drawer_list'),
      achMetric:   document.getElementById('ach_metric'),
      achName:     document.getElementById('ach_name'),
      achMetricValue: document.getElementById('ach_metric_value'),
      achBase:     document.getElementById('ach_base'),
      achPort:     document.getElementById('ach_port'),
      achDisb:     document.getElementById('ach_disb'),
      achColl:     document.getElementById('ach_coll'),
      prodMonth:   document.getElementById('prod_month'),
      prodYear:    document.getElementById('prod_year'),
      prodMetric:  document.getElementById('prod_metric'),
      prodTotal:   document.getElementById('prod_total'),
      prodFO:      document.getElementById('prod_fo'),
      prodAvg:     document.getElementById('prod_avg'),
      scCompany:   document.getElementById('sc_company'),
      scRegion:    document.getElementById('sc_region'),
      scDistrict:  document.getElementById('sc_district'),
      scBranch:    document.getElementById('sc_branch'),
      scInd:       document.getElementById('scope_ind')
    };

    // Columns (for header only; no data)
    const DISPLAY_COLS = [
      "Sl.no", "Employee ID", "Year", "Month", "Name", "Designation",
      "State", "Region", "District", "Branch Name", "Branch Code",
      "Number of Centers Handling", "Active Accounts", "Total Portfolio ‚Äì Amount",
      "Regular Portfolio ‚Äì Account", "Regular Portfolio ‚Äì Amount",
      "1+ PAR ‚Äì Account", "1+ PAR ‚Äì Amount", "NPA ‚Äì Account", "NPA ‚Äì Amount",
      "FTOD ‚Äì Account", "FTOD ‚Äì Amount", "Audit Rating"
    ];

    function buildEmptyTable() {
      const table = el.rowsTable;
      table.innerHTML = "";
      const thead = document.createElement('thead');
      const trHead = document.createElement('tr');
      DISPLAY_COLS.forEach(col => {
        const th = document.createElement('th');
        th.textContent = col;
        th.className = "th-sort";
        trHead.appendChild(th);
      });
      thead.appendChild(trHead);
      table.appendChild(thead);

      const tbody = document.createElement('tbody');
      const tr = document.createElement('tr');
      const td = document.createElement('td');
      td.colSpan = DISPLAY_COLS.length;
      td.style.textAlign = "center";
      td.style.padding = "1rem";
      td.style.color = "var(--muted)";
      td.textContent = "UI demo ‚Äî connect your data source (Supabase, API, etc.) to see rows here.";
      tr.appendChild(td);
      tbody.appendChild(tr);
      table.appendChild(tbody);

      el.rowsCount.textContent = "0 rows";
      el.pageInfo.textContent = "Page 1 of 1";
      el.btnPrev.disabled = true;
      el.btnNext.disabled = true;
    }

    function initAchieverSection() {
      const metrics = [
        "Regular Portfolio ‚Äì Amount",
        "Total Portfolio ‚Äì Amount",
        "Active Accounts"
      ];
      metrics.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m;
        opt.textContent = m;
        el.achMetric.appendChild(opt);
      });
      el.achMetric.addEventListener('change', () => {
        showToast("Achiever metric changed (UI only, no data)");
      });
    }

    function initProductivitySection() {
      const now = new Date();
      const thisYear = now.getFullYear();
      const months = Array.from({ length: 12 }, (_, i) => i + 1);

      el.prodMonth.innerHTML = "";
      months.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m;
        opt.textContent = m.toString().padStart(2, "0");
        el.prodMonth.appendChild(opt);
      });
      el.prodMonth.value = now.getMonth() + 1;

      el.prodYear.innerHTML = "";
      [thisYear - 1, thisYear].forEach(y => {
        const opt = document.createElement('option');
        opt.value = y;
        opt.textContent = y;
        el.prodYear.appendChild(opt);
      });
      el.prodYear.value = thisYear;

      ["Amount", "Accounts"].forEach(m => {
        const opt = document.createElement('option');
        opt.value = m;
        opt.textContent = "Sample " + m;
        el.prodMetric.appendChild(opt);
      });

      const markDemo = () => {
        el.prodTotal.textContent = "‚Äî";
        el.prodFO.textContent = "‚Äî";
        el.prodAvg.textContent = "‚Äî";
        showToast("Productivity is a UI demo ‚Äî hook to data to compute values.");
      };

      el.prodMonth.addEventListener('change', markDemo);
      el.prodYear.addEventListener('change', markDemo);
      el.prodMetric.addEventListener('change', markDemo);
    }

    // Simple scope button toggling
    function setScope(scope) {
      const map = {
        Company: el.scCompany,
        Region: el.scRegion,
        District: el.scDistrict,
        Branch: el.scBranch
      };
      Object.keys(map).forEach(k => {
        map[k].setAttribute("aria-pressed", String(k === scope));
      });
      el.scInd.textContent = "Current: " + scope + " (UI demo)";
    }

    el.scCompany.addEventListener('click', () => setScope("Company"));
    el.scRegion.addEventListener('click',  () => setScope("Region"));
    el.scDistrict.addEventListener('click',() => setScope("District"));
    el.scBranch.addEventListener('click',  () => setScope("Branch"));

    // Column popover
    el.colsBtn.addEventListener('click', () => {
      el.colsPop.classList.toggle('show');
      el.colsBtn.setAttribute('aria-expanded', el.colsPop.classList.contains('show') ? 'true':'false');
    });
    document.addEventListener('click', (e) => {
      if (!el.colsPop.contains(e.target) && e.target !== el.colsBtn) {
        el.colsPop.classList.remove('show');
        el.colsBtn.setAttribute('aria-expanded','false');
      }
    });

    // Fullscreen (still works, but for empty table)
    el.btnFS.addEventListener('click', async () => {
      try {
        if (document.fullscreenElement === el.tableBox) await document.exitFullscreen();
        else if (!document.fullscreenElement) await el.tableBox.requestFullscreen();
        else { await document.exitFullscreen(); await el.tableBox.requestFullscreen(); }
      } catch(e) {
        console.warn('Fullscreen not available:', e);
      }
    });
    el.btnFSX.addEventListener('click', () => document.exitFullscreen().catch(() => {}));
    document.addEventListener('fullscreenchange', () => {
      const on = (document.fullscreenElement === el.tableBox);
      el.btnFS.textContent = on ? 'üóó' : '‚õ∂';
      el.btnFS.title = on ? 'Exit fullscreen' : 'Enter fullscreen';
    });

    // Buttons (Refresh / CSV / XLSX / Print) ‚Äî UI only
    el.btnRefresh.addEventListener('click', () => {
      showToast("Refresh clicked ‚Äî connect to Supabase/API to load data.");
      el.tick.style.background = "#22c55e";
      setTimeout(() => el.tick.style.background = "var(--border)", 1200);
    });
    el.btnDownload.addEventListener('click', () => {
      showToast("CSV export is not wired ‚Äî this is a UI-only mock.");
    });
    el.btnXlsx.addEventListener('click', () => {
      showToast("XLSX export is not wired ‚Äî this is a UI-only mock.");
    });
    el.btnPrint.addEventListener('click', () => {
      showToast("Print works on the UI, but table has no data.");
      window.print();
    });

    // Staff breakdown click: open empty drawer
    document.querySelectorAll('.staff-count').forEach(div => {
      div.addEventListener('click', () => {
        el.drawerTitle.textContent = div.getAttribute('data-bucket') + " ‚Äî UI demo";
        el.drawerMeta.textContent = "Connect data source to list staff here.";
        el.drawerList.innerHTML = "";
        el.drawer.classList.add('show');
      });
    });
    el.drawerClose.addEventListener('click', () => el.drawer.classList.remove('show'));

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'TEXTAREA') {
        if (e.key === 'Escape') e.target.blur();
        return;
      }
      if (e.key === '/') { e.preventDefault(); el.search.focus(); }
      if (e.key === 'b' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.branchSelect.focus(); }
      if (e.key === 'f' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.btnFS.click(); }
      if (e.key === 'r' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.btnRefresh.click(); }
      if (e.key === 'd' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.btnDownload.click(); }
      if (e.key === 'x' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.btnXlsx.click(); }
      if (e.key === 'p' && !e.ctrlKey && !e.metaKey) { e.preventDefault(); el.btnPrint.click(); }
      if (e.key === 'Escape' && el.drawer.classList.contains('show')) { el.drawer.classList.remove('show'); }
    });

    // Offline indicator
    function updateOnline() {
      el.offline.classList.toggle('show', !navigator.onLine);
    }
    window.addEventListener('online', updateOnline);
    window.addEventListener('offline', updateOnline);
    updateOnline();

    // Init
    buildEmptyTable();
    initAchieverSection();
    initProductivitySection();
    setScope("Branch");
  </script>
</body>
</html>
